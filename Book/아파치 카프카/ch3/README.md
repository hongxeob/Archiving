# 3. 카프카 기본 개념 설명

## 3.1 카프카 브로커, 클로스터 주키퍼
카프카 브로커는
- 하나의 서버에는 한 개의 카프카 브로커가 실행된다.
- **3대 이상을 묶어서 클러스터**로 운영한다.
- 데이터를 전달받아 토픽의 파티션에 데이터를 저장하고, 전달한다.
- 데이터는 **파일 시스템**에 저장된다.
> 카프카는 데이터를 메모리나 데이터베이스가 아니라 파일에 저장하는데, `파일 시스템에 저장하면 파일 입출력으로 인해 느리지 않을까?`
> - 카프카는 페이지 캐시(page cache)를 사용해 디스크 입출력 속도를 높였다.
> - 한 번 읽은 파일의 내용은 메모리의 페이지 캐시 영역에 저장된다.
> - JVM 상에서 동작하는 카프카가 직접 캐시를 구현하는 게 아니다. (그랬더라면 gc가 자주 일어났을 것이다.)
>   - 그래서 카프카 힙 사이즈를 크게 설정하지 않아도 된다.
### 데이터 복제, 싱크
장애 발생시에도 데이터를 유실하지 않고 안전하게 사용하기 위해서 데이터 복제(싱크)를 진행한다.<br>
카프카의 데이터 복제는 **파티션 단위**로 이루어지며 복제된 파티션은 `리더` & `팔로워`로 구성된다.<br>
- 팔로워의 파티션은 리더 파티션으로부터 데이터를 가져와서 자신의 파티션에 저장한다.
- 복제 개수만큼 저장 용량이 증가한다는 단점을 가지고 있다.
- 리더 파티션에 장애가 발생하면 다른 팔로워 파티션이 그 기능을 위임 받는다.
