# DDDë€

DDD(Domain-Driven Design). ì§ì—­í•˜ë©´ **ë„ë©”ì¸**ì„ ì´ìš©í•œ ë””ìì¸!

## 1. ë„ë©”ì¸ì´ë€?

ì†Œí”„íŠ¸ì›¨ì–´ë¡œ í•´ê²°í•˜ê³ ì í•˜ëŠ” **ë¬¸ì œ ì˜ì—­**ì„ ì˜ë¯¸í•œë‹¤.

>ì˜¨ë¼ì¸ ì‡¼í•‘ëª° ì„œë¹„ìŠ¤ì˜  ê²½ìš°
>- ìƒí’ˆ ê´€ë¦¬, ì£¼ë¬¸ ì²˜ë¦¬, ë°°ì†¡ ê´€ë¦¬, ê³ ê° ê´€ë¦¬ ë“±..

- ê°ê°ì˜ ì˜ì—­ì€ ê³ ìœ í•œ **ê·œì¹™ê³¼** **ì •ì±…**ì„ ê°€ì§„ë‹¤.
- í•œ ë„ë©”ì¸ì€ ë‹¤ì‹œ í•˜ìœ„ ë„ë©”ì¸ìœ¼ë¡œ ë‚˜ë‰ ìˆ˜ë„ ìˆë‹¤.

ì‡¼í•‘ëª° ë„ë©”ì¸ì€ ì•„ë˜ì™€ ê°™ì´ ëª‡ê°œì˜ í•˜ìœ„ ë„ë©”ì¸ìœ¼ë¡œ ë‚˜ëˆŒìˆ˜ë„ ìˆë‹¤.

![img.png](img/img.png)
- ê°ê°ì˜ í•˜ìœ„ ë„ë©”ì¸ë“¤ì€ í•´ë‹¹ ë„ë©”ì¸ì—ì„œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ê·œì¹™ê³¼ ì •ì±…ìœ¼ë¡œ ë¹„ì¦ˆë‹ˆìŠ¤ë¥¼ ë‹´ë‹¹í•œë‹¤.
- í•˜ì§€ë§Œ íŠ¹ì • ë„ë©”ì¸ì„ ìœ„í•œ ì†Œí”„íŠ¸ì›¨ì–´ë¼ê³  í•´ì„œ ë„ë©”ì¸ì´ ì œê³µí•´ì•¼í•  ëª¨ë“  ê¸°ëŠ¥ì„ ì§ì ‘ ë‹¤ êµ¬í˜„í•˜ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤!
    - ì˜ˆë¥¼ ë“¤ì–´ ë°°ì†¡,ê²°ì œ ì‹œìŠ¤í…œì€ ì™¸ë¶€ì˜ ì‹œìŠ¤í…œì„ ì—°ë™í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ë„ ìˆë‹¤.

![img_1.png](img/img1.png)
## 2. ë„ë©”ì¸ ëª¨ë¸ì˜ ì¤‘ìš”ì„±

- ê¸°ë³¸ì ìœ¼ë¡œ ë„ë©”ì¸ ëª¨ë¸ì€ íŠ¹ì • ë„ë©”ì¸ì„ ê°œë…ì ìœ¼ë¡œ í‘œí˜„í•œ ê²ƒ
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ í‘œí˜„í•˜ëŠ” ìˆ˜ë‹¨
- ë„ë©”ì¸ ì „ë¬¸ê°€ì™€ ê°œë°œì ê°„ì˜ ê³µí†µ ì–¸ì–´ ì—­í•  (ìœ ë¹„ì¿¼í„°ìŠ¤ ì–¸ì–´)

### ì£¼ë¬¸(Order) ëª¨ë¸ì„ ê°ì²´ ëª¨ë¸ë¡œ êµ¬ì„±í•˜ë©´

![img.png](img/img2.png)
ì´ë ‡ê²Œ ë„ë©”ì¸ ëª¨ë¸ì„ ì‚¬ìš©í•˜ë©´ ì—¬ëŸ¬ ê´€ê³„ìë“¤ì´ ë™ì¼í•œ ëª¨ìŠµìœ¼ë¡œ ë„ë©”ì¸ì„ ì´í•´í•˜ê³  ë„ë©”ì¸ ì§€ì‹ì„ ê³µìœ í•˜ëŠ”ë° ë„ì›€ì´ ëœë‹¤!

ë”ë¶ˆì–´ ì•„ë˜ ê°™ì€ ìƒíƒœ ë‹¤ì´ì–´ê·¸ë¨ì„ ì´ìš©í•˜ë©´ ë”ìš± ì£¼ë¬¸ ëª¨ë¸ë§ì— ëŒ€í•˜ì—¬ ì´í•´ë„ê°€ ë†’ì•„ì§„ë‹¤.
![img.png](img/img3.png)
## 3. ë„ë©”ì¸ ëª¨ë¸ íŒ¨í„´

ì¼ë°˜ì ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ì•„í‚¤í…ì²˜ëŠ” ì•„ë˜ì²˜ëŸ¼ í¬ê²Œ ë„¤ ê°œì˜ ì˜ì—­ìœ¼ë¡œ êµ¬ì„±ëœë‹¤.
![img.png](img/img4.png)

| ì˜ì—­ | ì„¤ëª… |
| --- | --- |
| ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ OR í‘œí˜„ ì˜ì—­
(Presentation) | ì‚¬ìš©ìì˜ ìš”ì²­ì„ ì²˜ë¦¬í•˜ê³  ì‚¬ìš©ìì—ê²Œ ì •ë³´ë¥¼ ë³´ì—¬ì¤€ë‹¤. **ì—¬ê¸°ì„œ ì‚¬ìš©ìëŠ” ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ì‚¬ìš©í•˜ëŠ” ì‚¬ëŒë¿ë§Œ ì•„ë‹ˆë¼ ì™¸ë¶€ ì‹œìŠ¤í…œ ì¼ìˆ˜ë„ ìˆë‹¤.** |
| Application | ì‚¬ìš©ìê°€ ìš”ì²­í•œ ê¸°ëŠ¥ì„ ì‹¤í–‰í•œë‹¤. **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì§ì ‘ êµ¬í˜„í•˜ì§€ ì•Šìœ¼ë©°** ë„ë©”ì¸ ê³„ì¸µì„ ì¡°í•©í•´ì„œ ê¸°ëŠ¥ì„ ì‹¤í–‰í•œë‹¤. íŠ¸ëœì­ì…˜ ì²˜ë¦¬ |
| Domain | ì‹œìŠ¤í…œì´ ì œê³µí•  ë„ë©”ì¸ ê·œì¹™ì„ êµ¬í˜„í•œë‹¤. |
| Infrastructure | DBë‚˜ ë©”ì‹œì§• ì‹œìŠ¤í…œê³¼ ê°™ì€ ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ì˜ ì—°ë™ì„ ì²˜ë¦¬í•œë‹¤. |

## 4. ë„ë©”ì¸ ëª¨ë¸ ë„ì¶œ
> ğŸ’¡ì•„ë¬´ë¦¬ ë›°ì–´ë‚œ ê°œë°œìë¼ í• ì§€ë¼ë„ ë„ë©”ì¸ì— ëŒ€í•œ ì´í•´ ì—†ì´ ê°œë°œì„ ì‹œì‘í•  ìˆ˜ëŠ” ì—†ë‹¤.<br>
>ê¸°íšì„œ, ìœ ì¦ˆì¼€ì´ìŠ¤, ì‚¬ìš©ì ìŠ¤í† ë¦¬ì™€ ê°™ì€ ìš”êµ¬ì‚¬í•­ê³¼ ê´€ë ¨ìì˜ ëŒ€í™”ë¥¼ í†µí•´ ë„ë©”ì¸ì„ ì´í•´í•˜ê³  ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë„ë©”ì¸ ëª¨ë¸ ì´ˆì•ˆì„ ë§Œë“¤ì–´ì•¼ ë¹„ë¡œì†Œ ì•ˆì •ì ì¸ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.

### ë„ë©”ì¸ì„ ëª¨ë¸ë§ í•  ë•Œ ê¸°ë³¸ì´ ë˜ëŠ” ì‘ì—…

- ëª¨ë¸ì„ êµ¬ì„±í•˜ëŠ” í•µì‹¬ êµ¬ì„±ìš”ì†Œ ì°¾ê¸°
- ê·œì¹™ ì°¾ê¸°
- ê¸°ëŠ¥ ì°¾ê¸°

ìœ„ì˜ ê³¼ì •ì€ **ìš”êµ¬ì‚¬í•­**ì—ì„œ ì¶œë°œí•œë‹¤!!!

### `ì£¼ë¬¸` ë„ë©”ì¸ê³¼ ê´€ë ¨ëœ ëª‡ê°€ì‹œ ìš”êµ¬ì‚¬í•­ì„ ë³´ì.

- ìµœì†Œ í•œ ì¢…ë¥˜ ì´ìƒì˜ ìƒí’ˆì„ ì£¼ë¬¸í•´ì•¼ í•œë‹¤.
- í•œ ìƒí’ˆì„ í•œ ê°œ ì´ìƒ ì£¼ë¬¸í•  ìˆ˜ ìˆë‹¤.
- ì´ ì£¼ë¬¸ ê¸ˆì•¡ì€ ê° ìƒí’ˆì˜ êµ¬ë§¤ ê°€ê²© í•©ì„ ëª¨ë‘ ë”í•œ ê¸ˆì•¡ì´ë‹¤.
- ê° ìƒí’ˆì˜ êµ¬ë§¤ ê°€ê²© í•©ì€ ìƒí’ˆ ê°€ê²©ì— êµ¬ë§¤ ê°œìˆ˜ë¥¼ ê³±í•œ ê°’ì´ë‹¤.
- ì£¼ë¬¸í• ë•Œ ë°°ì†¡ì§€ ì •ë³´ë¥¼ ë°˜ë“œì‹œ ì§€ì •í•´ì•¼ í•œë‹¤.
- ë°°ì†¡ì§€ ì •ë³´ëŠ” ë°›ëŠ” ì‚¬ëŒ ì´ë¦„, ì „í™”ë²ˆí˜¸, ì£¼ì†Œë¡œ êµ¬ì„±ëœë‹¤.
- ì¶œê³ ë¥¼ í•˜ë©´ ë°°ì†¡ì§€ë¥¼ ë³€ê²½í•  ìˆ˜ ì—†ë‹¤.
- ì¶œê³  ì „ì— ì£¼ë¬¸ì„ ì·¨ì†Œí•  ìˆ˜ ìˆë‹¤.
- ê³ ê°ì— ê²°ì œë¥¼ ì™„ë£Œí•˜ê¸° ì „ì—ëŠ” ìƒí’ˆì„ ì¤€ë¹„í•˜ì§€ ì•ŠëŠ”ë‹¤.

ì´ ìš”êµ¬ì‚¬í•­ì—ì„œ ì•Œ ìˆ˜ ìˆëŠ” ê²ƒ 

- ì£¼ë¬¸ì€ `'ì¶œê³  ìƒíƒœë¡œ ë³€ê²½í•˜ê¸°'`, `'ë°°ì†¡ì§€ ì •ë³´ ë³€ê²½í•˜ê¸°'`, `'ì£¼ë¬¸ ì·¨ì†Œí•˜ê¸°'`, `'ê²°ì œ ì™„ë£Œí•˜ê¸°'` ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.

```java
public class Order {
	public void changeShipped() { ... }
	public void changeShippingInfo(ShippingInfo newShipping) { ... }
	public void cancel() { ... }
	public void completePayment() { ... }
}
```

ì•„ë˜ ìš”êµ¬ì‚¬í•­ìœ¼ë¡œ ì£¼ë¬¸í•­ ëª©ì´ ì–´ë–¤ ë°ì´í„°ë¡œ êµ¬ì„±ë˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆë‹¤.

- í•œ ìƒí’ˆì„ í•œ ê°œ ì´ìƒ ì£¼ë¬¸í•  ìˆ˜ ìˆë‹¤.
- ê° ìƒí’ˆì˜ êµ¬ë§¤ ê°€ê²© í•©ì€ ìƒí’ˆ ê°€ê²©ì— êµ¬ë§¤ ê°œìˆ˜ë¥¼ ê³±í•œ ê°’ì´ë‹¤.

```java
//ì£¼ë¬¸ í•­ëª©ì„ í‘œí˜„í•˜ëŠ” OrderLine
public class OrderLine {
	private Product product;
	private int price;
	private int quantity;
	private int amount;

	public OrderLine(ProductId productId, Money price, int quantity) {
        this.productId = productId;
        this.price = price;
        this.quantity = quantity;
        this.amounts = calculateAmounts();
    }

    private Money calculateAmounts() {
        return price.multiply(quantity);
    }
    
    ...
}
```

ë‹¤ìŒ ìš”êµ¬ì‚¬í•­ì€ `Order` <-> `OrderLine` ê´€ê³„ë¥¼ ì•Œë ¤ì¤€ë‹¤.

- ìµœì†Œ í•œ ì¢…ë¥˜ ì´ìƒì˜ ìƒí’ˆì„ ì£¼ë¬¸í•´ì•¼í•œë‹¤.
    - í•œ ì¢…ë¥˜ ì´ìƒì˜ ìƒí’ˆì„ ì£¼ë¬¸í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ OrderëŠ” ìµœì†Œ í•œ ê°œ ì´ìƒì˜ OrderLineì„ ê°€ì ¸ì•¼í•œë‹¤.
- ì´ ì£¼ë¬¸ ê¸ˆì•¡ì€ ê° ìƒí’ˆì˜ êµ¬ë§¤ ê°€ê²© í•©ì„ ëª¨ë‘ ë”í•œ ê¸ˆì•¡ì´ë‹¤.
    - ì´ ì£¼ë¬¸ ê¸ˆì•¡ì€ OrderLineì—ì„œ êµ¬í•  ìˆ˜ ìˆë‹¤.

```java
public class Order {
	private List<OrderLine> orderLines;
    private Money totalAmounts;
    
    public Order(List<OrderLine> orderLines) {
        setOrderLines(orderLines);
    }
    
    private void setOrderLines(List<OrderLine> orderLines) {
        verifyAtLeastOneOrMoreOrderLines(orderLines);
        this.orderLines = orderLines;
        calculateTotalAmounts();
    }

    private void verifyAtLeastOneOrMoreOrderLines(List<OrderLine> orderLines) {
        if (orderLines == null || orderLines.isEmpty()) {
            throw new IllegalArgumentException("no OrderLine");
        }
    }

    private void calculateTotalAmounts() {
        this.totalAmounts = new Money(orderLines.stream()
                .mapToInt(x -> x.getAmounts().getValue()).sum());
    }
}
```

## 5. ì—”í‹°í‹°ì™€ ë°¸ë¥˜

ìœ„ì˜ ì‘ì—…ì—ì„œ ë„ì¶œí•œ ëª¨ë¸ì€ í¬ê²Œ ì—”í‹°í‹°(Entity)ì™€ ë°¸ë¥˜(Value)ë¡œ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤.
>ì—”í‹°í‹°ì™€ ë°¸ë¥˜ë¥¼ ì œëŒ€ë¡œ êµ¬ë¶„í•´ì•¼ ëª¨ë°ì¸ì„ ì˜¬ë°”ë¥´ê²Œ ì„¤ê³„í•˜ê³  êµ¬í˜„í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—, ì´ ë‘˜ì˜ ì°¨ì´ë¥¼ ëª…í™•í•˜ê²Œ ì´í•´í•˜ëŠ” ê²ƒì€ ë„ë©”ì¸ì„ êµ¬í˜„í•˜ëŠ” ë° ìˆì–´ ì¤‘ìš”í•˜ë‹¤.

![img.png](img/img5.png)

### 1) ì—”í‹°í‹°

- ì‹ë³„ìë¥¼ ê°€ì§€ëŠ” ë„ë©”ì¸ ëª¨ë¸ì˜ ê°ì²´
- ì‹ë³„ìê°€ ê°™ìœ¼ë©´ ê°™ì€ ì—”í‹°í‹°ë¡œ ê°„ì£¼

ì˜ˆë¥¼ ë“¤ì–´ ì£¼ë¬¸ ë„ë©”ì¸ì—ì„œ ê° ì£¼ë¬¸ì€ ì£¼ë¬¸ë²ˆí˜¸ë¥¼ ê°€ì§€ê³  ìˆëŠ”ë° ì´ ì£¼ë¬¸ë²ˆí˜¸ëŠ” ê° ì£¼ë¬¸ë§ˆë‹¤ ì„œë¡œ ë‹¤ë¥´ë‹¤.

ë”°ë¼ì„œ ì£¼ë¬¸ë²ˆí˜¸ê°€ ì£¼ë¬¸ì˜ ì‹ë³„ìê°€ ëœë‹¤.

### 2) ì—”í‹°í‹°ì˜ ì‹ë³„ì ìƒì„±

- íŠ¹ì • ê·œì¹™ì— ë”°ë¼ ìƒì„±
    - ì£¼ë¬¸ë²ˆí˜¸, ìš´ì†¡ì¥ë²ˆí˜¸, ì¹´ë“œë²ˆí˜¸ì™€ ê°™ì€ ì‹ë³„ìëŠ” íŠ¹ì • ê·œì¹™ì— ë”°ë¼ ìƒì„±í•œë‹¤.
    - ì´ ê·œì¹™ì€ ë„ë©”ì¸ì— ë”°ë¼ ë‹¤ë¥´ê³ , ê°™ì€ ì£¼ë¬¸ë²ˆí˜¸ë¼ë„ íšŒì‚¬ë§ˆë‹¤ ë‹¤ë¥´ë‹¤.
- ì§ì ‘ ìƒì„±: ì‚¬ìš©ìê°€ ì§ì ‘ ì…ë ¥
- ìë™ ìƒì„±: UUID, ì‹œí€€ìŠ¤, ê°’ ì¡°í•© ë“±

### 3) ë°¸ë¥˜ íƒ€ì…

- ê°œë…ì ìœ¼ë¡œ ì™„ì „í•œ í•˜ë‚˜ë¥¼ í‘œí˜„í•˜ëŠ” ê°ì²´
- ì‹ë³„ìë¥¼ ê°–ì§€ ì•ŠìŒ
- **ë¶ˆë³€ ê°ì²´**ë¡œ êµ¬í˜„í•˜ëŠ” ê²ƒì„ ê¶Œì¥

`ShippingInfo` í´ë˜ìŠ¤ëŠ” ë°›ëŠ” ì‚¬ëŒê³¼ ì£¼ì†Œì— ëŒ€í•œ ë°ì´í„°ë¥¼ ê°–ê³  ìˆë‹¤.

```java
public class ShippingInfo {
    private String receiverName; // ë°›ëŠ” ì‚¬ëŒ
    private String receiverPhoneNumber // ë°›ëŠ” ì‚¬ëŒ
    
    private String shippingAddress1; // ì£¼ì†Œ
    private String shippingAddress2; // ì£¼ì†Œ
    private String zipcode; // ì£¼ì†Œ
}
```

ë°¸ë¥˜ íƒ€ì… `Address`, `Receiver` í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•œ ëª¨ìŠµì´ë‹¤. ë°°ì†¡ì •ë³´ê°€ ë°›ëŠ” ì‚¬ëŒê³¼ ì£¼ì†Œë¡œ êµ¬ì„±ëœë‹¤ëŠ” ê²ƒì„ ì‰½ê²Œ ì•Œ ìˆ˜ ìˆë‹¤.

- ë°¸ë¥˜ íƒ€ì…ì˜ ì¥ì ì€ ë°¸ë¥˜ íƒ€ì…ì„ ìœ„í•œ ê¸°ëŠ¥ì„ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.
    - ex) Money ê°ì²´ì—ì„œì˜ ëˆ ê³„ì‚°, Address ê°ì²´ì—ì„œì˜ ì£¼ì†Œ ê²€ì¦ ë“±ë“±..

```java
public class ShippingInfo {
    private Address address;
    private Receiver receiver;
    
    /** í•´ë‹¹ ë°¸ë¥˜ íƒ€ì…ì— ëŒ€í•œ íŠ¹ìˆ˜ ê²€ì¦ì´ë‚˜ íŠ¹ìˆ˜ ê¸°ëŠ¥ì„ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤. **/
}
```

## 6. ì—”í‹°í‹° ì‹ë³„ìì™€ ë°¸ë¥˜ íƒ€ì…

>ì—”í‹°í‹° ì‹ë³„ìì˜ ì‹¤ì œ ë°ì´í„°ëŠ” Stringê³¼ ê°™ì€ ë¬¸ìì—´ë¡œ êµ¬ì„±ëœ ê²½ìš°ê°€ ë§ë‹¤. (JPA ìƒê° í•˜ì§€ë§ê³ ..!) <br> 
>í•˜ì§€ë§Œ Moneyê°€ ë‹¨ìˆœ ìˆ«ìê°€ ì•„ë‹Œ ë„ë©”ì¸ì˜ â€˜ëˆâ€™ì„ ì˜ë¯¸í•˜ëŠ” ê²ƒì²˜ëŸ¼ ì´ëŸ° ì‹ë³„ìëŠ” ë‹¨ìˆœí•œ ë¬¸ìì—´ì´ ì•„ë‹ˆë¼ ë„ë©”ì¸ì—ì„œ íŠ¹ë³„í•œ ì˜ë¯¸ë¥¼ ì§€ë‹ˆëŠ” ê²½ìš°ê°€ ë§ê¸° ë•Œë¬¸ì— ì‹ë³„ìë¥¼ ìœ„í•œ ë°¸ë¥˜ íƒ€ì…ì„ ì‚¬ìš©í•´ì„œ **ì˜ë¯¸ë¥¼ ì˜ ë“œëŸ¬ë‚´ì!!**

## 7. ë„ë©”ì¸ ëª¨ë¸ì— set ë©”ì„œë“œ ë„£ì§€ ì•Šê¸°

- set ë©”ì„œë“œëŠ” ë„ë©”ì¸ì˜ ì˜ë¯¸ë‚˜ ì˜ë„ë¥¼ í‘œí˜„í•˜ì§€ ëª»í•¨
- ì˜ë¯¸ê°€ ë“œëŸ¬ë‚˜ëŠ” ë©”ì„œë“œ ì‚¬ìš©

```java
public class Order {
    ...

    public void setShippingInfo(ShippingInfo shippingInfo) {
        if (shippingInfo == null) throw new IllegalArgumentException("no shipping info");
        this.shippingInfo = shippingInfo;
    }
    
    public void setOrderState(OrderState state) { ...}
}
// setShippingInfo() ë©”ì„œë“œëŠ” ë‹¨ìˆœíˆ ë°°ì†¡ì§€ ê°’ì„ ì„¤ì •í•œë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.
// setOrderState()ëŠ” ë‹¨ìˆœíˆ ì£¼ë¬¸ ìƒíƒœ ê°’ì„ ì„¤ì •í•œë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. 
```

- `setOrderState()`ëŠ” ë‹¨ìˆœíˆ ìƒíƒœê°’ë§Œ ë³€ê²½í• ì§€ ì•„ë‹ˆë©´ ìƒíƒœê°’ì— ë”°ë¼ ë‹¤ë¥¸ ì²˜ë¦¬ë¥¼ ìœ„í•œ ì½”ë“œë¥¼ í•¨ê»˜ êµ¬í˜„í• ì§€ ì• ë§¤í•˜ë‹¤.
- ìŠµê´€ì ìœ¼ë¡œ ì‘ì„±í•œ set ë©”ì„œë“œëŠ” í•„ë“œê°’ë§Œ ë³€ê²½í•˜ê³  ëë‚˜ê¸° ë•Œë¬¸ì— ìƒíƒœ ë³€ê²½ê³¼ ê´€ë ¨ëœ ë„ë©”ì¸ ì§€ì‹ì´ ì½”ë“œì—ì„œ ì‚¬ë¼ì§€ê²Œëœë‹¤.

```java
// set ë©”ì„œë“œë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ë„ë¡ êµ¬í˜„í•˜ë©´, ì²˜ìŒ Orderë¥¼ ìƒì„±í•˜ëŠ” ì‹œì ì— orderëŠ” ì™„ì „í•˜ì§€ ì•Šë‹¤.
Order order = new Order();

// set ë©”ì„œë“œë¡œ í•„ìš”í•œ ëª¨ë“  ê°’ì„ ì „ë‹¬í•´ì•¼í•œë‹¤.
setOrderLines(orderLines);
setShippingInfo(shippingInfo);

// ì£¼ë¬¸ì(Orderer)ë¥¼ ì„¤ì •í•˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ ì£¼ë¬¸ ì™„ë£Œ ì²˜ë¦¬
order.setState(OrderState.PREPARING);
```

- ì£¼ë¬¸ì ì„¤ì •ì´ ëˆ„ë½ëœ ì½”ë“œë‹¤. ì£¼ë¬¸ì ì •ë³´ë¥¼ ë‹´ê³ ìˆëŠ” í•„ë“œì¸ orderlerê°€ nullì¸ ìƒí™©ì—ì„œ setState() ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ ìƒíƒœê°’ì„ ë³€ê²½í•˜ì˜€ë‹¤.
- ì´ê±¸ í•´ê²°í•˜ê³ ì, setState() ë©”ì„œë“œì— orderer í•„ë“œì˜ null ì²´í¬ë¥¼ ë„£ëŠ” ê²ƒë„ ë§ì§€ ì•Šë‹¤.

ë„ë©”ì¸ ê°ì²´ê°€ ë¶ˆì™„ì „í•œ ìƒíƒœë¡œ ì‚¬ìš©ë˜ëŠ” ê²ƒì„ ë§‰ìœ¼ë ¤ë©´ ìƒì„± ì‹œì ì— í•„ìš”í•œ ê²ƒì„ ì „ë‹¬í•´ì£¼ì–´ì•¼ í•œë‹¤. ì¦‰, ìƒì„±ìë¥¼ í†µí•´ í•„ìš”í•œ ë°ì´í„°ë¥¼ ëª¨ë‘ ë°›ì•„ì•¼í•œë‹¤.

```java
Order oder = new Order(orderer, lines, shippingInfo, OrderState.PREPARING);
```

```java
public class Order {
    ...

    public Order(OrderNo number, Orderer orderer, List<OrderLine> orderLines,
                 ShippingInfo shippingInfo, OrderState state) {
        setNumber(number);
        setOrderer(orderer);
        setOrderLines(orderLines);
        setShippingInfo(shippingInfo);
        this.state = state;
        this.orderDate = LocalDateTime.now();
        Events.raise(new OrderPlacedEvent(number.getNumber(), orderer, orderLines, orderDate));
    }

    private void setNumber(OrderNo number) {
        if (number == null) throw new IllegalArgumentException("no number");
        this.number = number;
    }

    private void setOrderer(Orderer orderer) {
        if (orderer == null) throw new IllegalArgumentException("no orderer");
        this.orderer = orderer;
    }

    private void setOrderLines(List<OrderLine> orderLines) {
        verifyAtLeastOneOrMoreOrderLines(orderLines);
        this.orderLines = orderLines;
        calculateTotalAmounts();
    }

    private void verifyAtLeastOneOrMoreOrderLines(List<OrderLine> orderLines) {
        if (orderLines == null || orderLines.isEmpty()) {
            throw new IllegalArgumentException("no OrderLine");
        }
    }

    private void calculateTotalAmounts() {
        this.totalAmounts = new Money(orderLines.stream()
                .mapToInt(x -> x.getAmounts().getValue()).sum());
    }

    private void setShippingInfo(ShippingInfo shippingInfo) {
        if (shippingInfo == null) throw new IllegalArgumentException("no shipping info");
        this.shippingInfo = shippingInfo;
    }
    
    ...
}
```

### `'private'` ë©”ì„œë“œì„ì— ì£¼ëª©í•˜ì.

- ì´ ì½”ë“œì˜ set ë©”ì„œë“œëŠ” í´ë˜ìŠ¤ ë‚´ë¶€ì—ì„œ ë°ì´í„°ë¥¼ ë³€ê²½í•  ëª©ì ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤.
    - private ì´ê¸° ë•Œë¬¸ì— ì™¸ë¶€ì—ì„œ ë°ì´í„°ë¥¼ ë³€ê²½í•  ëª©ì ìœ¼ë¡œ set ë©”ì„œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.
- ë¶ˆë³€ ë°¸ë¥˜ íƒ€ì…ì„ ì‚¬ìš©í•˜ë©´ ìì—°ìŠ¤ëŸ½ê²Œ ë°¸ë¥˜ íƒ€ì…ì—ëŠ” set ë©”ì„œë“œë¥¼ êµ¬í˜„í•˜ì§€ ì•ŠëŠ”ë‹¤.
- set ë©”ì„œë“œë¥¼ êµ¬í˜„í•´ì•¼í•  íŠ¹ë³„í•œ ì´ìœ ê°€ ì—†ë‹¤ë©´ ë¶ˆë³€ íƒ€ì…ì˜ ì¥ì ì„ ì‚´ë¦´ ìˆ˜ ìˆë„ë¡ ë°¸ë¥˜ íƒ€ì…ì€ ë¶ˆë³€ìœ¼ë¡œ êµ¬í˜„í•œë‹¤.
